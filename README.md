# Лабораторная работа №4
Вариант 2: Казино
## Запуск среды uv
```
uv venv
uv sync
```
Для Windows
```
.venv/Scripts/activate
```
Для Linux
```
source .venv/Scripts/activate
```
## Запуск симуляции
```
py -m src.main
```

# Правила казино
### 2 класса пользователей - игроки и гуси

## Игроки (class Player)
Носят имя и имеют баланс валюты для ставок - *player.name* и *player.balance*.

Баланс реализуется через класс CasinoBalance.

## Гуси (class Goose) и 3 подкласса
Носят имя *goose.name*, умеют красть у игроков деньги. Делать ставки на них не могут.

При попытке кражи гусь может ничего не украсть, или украсть до 50 валюты.

## Подкласс боевых гусей (class WarGoose)
Гуси, в функционал которых входит возможность атаковать игрока.

При атаке гусь отбирает у игрока 50 валюты.

## Подкласс кричащих гусей (class HonkGoose)
Гуси, в функционал которых входит возможность накричать на игрока. Имеют дополнительный параметр громкости крика *goose.honk_volume*.

Отнимает у игрока валюту в соответствии с громкостью, вплость до 100 валюты.
### В симуляции гуси не взаимодействуют с игроками с нулевым балансом. Если гусь пытается украсть больше, чем есть у игрока, то он забирает лишь то, что есть.
# Коллекции

## Коллекция игроков (class PlayerCollection)
Список с игроками. Позволяет добавлять, просматривать и удалять игроков. Также есть методы индексации, срезов, итерации - *dunder index, dunder getitem, dunder iter*.

## Коллекция гусей (class GooseCollection)
Аналогичный список для гусей. Не разделяет гусей по подклассам.

## Коллекция ставок (class ChipCollection)
Коллекция ставок игроков. Позволяет создавать, просматривать и разрешать ставки. Ставки завершаются по очереди при запуске разрешения ставки, начиная с самых старых.

При создании ставки у игрока сразу списывается валюта, при выигрыше возвращается сумма ставки, а также сумма, умноженная на коэффициент возврата. При создании ставки размером больше, чем баланс игрока - ошибка.
### Для каждой ставки случайно выбирается коэффициент возврата (от 0.5 до 1.5) - обратно ему меняется шанс выигрыша (от 75% до 25%)

# Баланс (class CasinoBalance)
Хранит число валюты пользователя, позволяет менять его и выводить.

Для изменения используется функция *dunder setitem*(имя игрока, значение) - для значения учитывается знак. Баланс не может уйти в минус: если гусь, например, пытается снять 50, а у игрока на балансе меньше, он теряет всё до нуля и не уходит в минус. Все изменения баланса логгируются в файле `balance.log`

# Казино (class Casino)
Объединение коллекций игроков, гусей, ставок в общую систему. Позволяет выводить все коллекции и исполнять все функции выше.

Поддерживает отдельную функцию *add_user* для добавления любого из пользователей при автоматическом определении типа для коллекции.

# Симуляция

## Поддерживаемые шаги симуляции
- Игрок делает ставку
- Одна из ставок разрешается
- Боевой гусь нападает на игрока
- Кричащий гусь кричит на игрока
- Любой гусь пытается украть у игрока валюту
- Игрок ставит весь свой баланс (all-in)

При запуске указывается количество шагов симуляции, а также сид при желании (Если не указать или указать не сид, то ошибки не будет). Для симуляции используется готовый набор из игроков и гусей из файла `constants.py`.

Сначала выводятся таблицы с игроками, балансами, а также таблица гусей. Во время симуляции выводятся все шаги. После симуляции выводится окончательная таблица игроков с их балансами, а также таблица с неразрешенными ставками.

Единственное условие, при котором симуляция не сможет дальше идти - у всех игроков закончатся деньги, и нет активных ставок. При таком исходе симуляция завершится раньше, и игроки будут считаться поверженными гусями.

# Запуск тестов через pytest
```
pytest .
```
